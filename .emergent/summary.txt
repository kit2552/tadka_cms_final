<analysis>**original_problem_statement:**
The initial request was to load the Tadka application, connect it to a remote production MongoDB, and ensure no test data is seeded.
This evolved through a series of feature requests:
1.  In the System Settings page, add a new API Keys tab.
2.  Add placeholders and forms to save API keys for Google Gemini, OpenAI, and Anthropic Claude.
3.  When saving keys, allow the user to see all available models from each provider and select a default model for content generation.
4.  Implement a feature to show the full, unmasked API key by clicking an icon.
5.  Add two new fields for global default model selection: Text Generation Models and Image Generation Models, populated with models from all three providers.
6.  Add a Refresh button next to these dropdowns to fetch the latest models from the providers.
7.  Update the model lists to include the latest versions (e.g., Claude 4.5, Gemini 3).
8.  Create a new page AI Agents accessible to admin users.
9.  This page should have a Create AI Agent button that opens a modal to select an agent type (e.g., Post Agent).
10. Implement the Post Agent form with Recurring and Adhoc modes, including fields for scheduling, topics, target state, word count, image options, and content workflow. The UI/UX should match existing dashboards.
11. Implement a Category-Prompt Mapping feature, allowing admins to create and manage custom AI prompts for each content category. The agent was asked to generate robust, dynamic default prompts for each category.
12. Add a Reference Content section to the agent form, allowing users to add multiple URLs to be used as source material for content generation.
13. Reorganize the form sections for better usability.
14. Refine the prompts for Movie News to incorporate state-to-language mapping.

**User's preferred language**: English

**what currently exists?**
The Tadka application, a full-stack News CMS (React/FastAPI/MongoDB), is fully operational and connected to the remote production database.

Significant feature development has occurred on two main fronts:
1.  **System Settings:** A comprehensive AI provider management section has been built. It allows users to store API keys for OpenAI, Gemini, and Anthropic, select default text and image generation models from a consolidated list, and refresh this list on-demand.
2.  **AI Agents:** A new page for managing AI Agents has been created. The UI for creating a Post Agent is complete, featuring a detailed form with two modes (Recurring/Adhoc) and advanced configuration options like scheduling, target state, word count, and content workflow. The core innovation is the Category-Prompt Mapping system, which allows admins to define specific, dynamic AI prompts for each content category. These prompts are pre-filled with intelligent defaults created by the agent. The form has been reorganized and styled according to user specifications.

**Last working item**:
-   Last item agent was working: The user requested a modification to the default AI prompt for the Movie News category. The requirement is that when the target state is set to All, the prompt should default to generating content in Hindi, rather than covering all regional cinemas. The agent acknowledged this and summarized the work before the user provided the final confirmation.
-   Status: **NOT STARTED**
-   Agent Testing Done: N
-   Which testing method agent to use? **Backend testing agent**. The change is a string modification in a Python file. The agent should instruct the testing agent to verify the change by calling the  endpoint and asserting the new prompt text for the  key.
-   User Testing Done: N

**All Pending/In progress Issue list**:
-   **Issue 1: (P0)** Update Movie News AI Prompt Logic.

    -   **Attempted fixes:** None. The agent was about to start this task.
    -   **Next debug checklist:**
        1.  Edit .
        2.  Locate the  dictionary.
        3.  Modify the prompt for the  key. Change the logic for the All states case from covering all regional cinemas to explicitly using Hindi as the default language for Bollywood news.
        4.  Restart the backend service: backend: stopped
backend: started.
        5.  Test the change by calling  and inspecting the  prompt.
    -   **Why fix this issue and what will be achieved with the fix?** This will align the AI content generation behavior with the user's specific requirements for handling national-level movie news.
    -   **Status:** NOT STARTED
    -   **Is recurring issue?** N
    -   **Should Test frontend/backend/both after fix?** Backend
    -   **Blocked on other issue:** None

**In progress Task List**:
-   None

**Upcoming and Future Tasks**
-   **Upcoming Tasks:**
    -   **(P1) Implement Core AI Content Generation Logic:** The UI and configuration are ready, but the backend service that executes the AI agents (runs the prompt against the selected model, uses reference URLs, and creates a draft post) is not yet implemented.
        -   **Files:**  (or a new dedicated service file), .
    -   **(P1) Implement Other Agent Types:** The agent selection modal includes Photo Gallery Agent and Review Agent as options, but their corresponding forms and backend logic have not been created.
        -   **Files:** Create  and ; update  to render them; create corresponding backend routes and CRUD functions.

**Completed work in this session**
-   **Tadka App Setup:** Successfully loaded the app and connected it to the remote production MongoDB.
-   **AI API Key Management:** Implemented a full-featured section in System Settings for managing keys and default models for OpenAI, Gemini, and Anthropic (, ).
-   **AI Agents Page:** Created the AI Agents page with a dashboard view ().
-   **Post Agent Form:** Built a detailed, multi-tabbed form for creating and configuring a Post Agent, including advanced UI controls like searchable dropdowns ().
-   **Category-Prompt Mapping:** Created a system to manage and assign dynamic, intelligent AI prompts to content categories, complete with default prompts (, ).
-   **Reference Content Section:** Added functionality to the agent form to accept multiple reference URLs for content generation ().

**Earlier issues found/mentioned but not fixed**
-   None.

**Known issue recurrence from previous fork**
-   None.

**Code Architecture**


**Key Technical Concepts**
-   **Frontend:** React, Tailwind CSS
-   **Backend:** FastAPI (Python)
-   **Database:** MongoDB
-   **Architecture:** Full-stack monolith with a clear separation between the React client and the FastAPI backend.
-   **AI Integration:** The application is built to manage and utilize user-provided API keys for content generation, with a sophisticated system for dynamic prompt engineering based on category and other agent settings.

**key DB schema**
-   **system_settings (collection):**
    -   A document with  stores .
    -   A document with  stores .
-   **ai_agents (collection):**
    -   Documents storing agent configurations including , ,  (recurring/adhoc), , , , , , , and .

**changes in tech stack**
-   None

**All files of reference**
-   **Created:**
    -   : API endpoints for AI agent CRUD.
    -   : Main dashboard for AI agents.
    -   : Modal for selecting agent type.
    -   : The comprehensive form for configuring a Post Agent.
-   **Updated:**
    -   : Registered the new AI agents router.
    -   : Added extensive logic for AI agents, API keys, and prompt mappings.
    -   : Added Pydantic models for AI agents.
    -   : Overhauled to include AI key and model management UI.
    -   : Added the route for the AI Agents page.
    -   : Added a link to the AI Agents page.

**Areas that need refactoring**:
-    has grown to over 800 lines. It handles state, API calls, and UI for the main form and two large modals. This component should be broken down into smaller, reusable components (e.g., , , ) to improve maintainability.

**key api endpoints**
-   : (GET, POST) List and create AI agents.
-   : (GET, PUT, DELETE) Manage a specific agent.
-   : (GET, POST) Manage mappings between categories and AI prompts.
-   : (GET, POST) Manage AI provider API keys.
-   : (GET) Retrieve unmasked keys.
-   : (GET) Fetch available text generation models.
-   : (GET) Fetch available image generation models.

**Critical Info for New Agent**
-   The user is highly detail-oriented about UI/UX. Ensure any new UI elements are compact, well-aligned, and consistent with the existing Manage Content dashboard styling.
-   The immediate next task is a small but specific change to an AI prompt in .
-   The main un-implemented feature is the actual execution of the AI agents. The entire configuration framework is built, but the service that runs the agents, generates content, and creates posts does not exist yet.

**documents created in this job**
-   None.

**Last 10 User Messages and any pending user messages**
1.  **Request:** Create a topic-category mapping feature. (Superseded)
2.  **Request:** Change to Category-Prompt mapping and generate robust default prompts. (Completed)
3.  **Request:** Remove the AI Prompt text area from the form UI. (Completed)
4.  **Request:** Add a Reference Content section for URLs and reorganize the form layout. (Completed)
5.  **Request:** Write new prompts for Movie News and Movie News Bollywood with state-language logic. (Completed)
6.  **Request:** Clarification on the Movie News prompt: if All is selected, default to Hindi. **(PENDING)**

**Project Health Check:**
-   **Broken:** The core functionality of the AI Agents feature (content generation) is not yet implemented.
-   **Mocked:** None. The application is using live production data.

**3rd Party Integrations**
-   **OpenAI:** Configured for API key management (requires User API Key).
-   **Google Gemini:** Configured for API key management (requires User API Key).
-   **Anthropic Claude:** Configured for API key management (requires User API Key).

**Testing status**
-   **Testing agent used after significant changes:** NO
-   **Troubleshoot agent used after agent stuck in loop:** NO
-   **Test files created:** None
-   **Known regressions:** None

**Credentials to test flow:**
-   No user credentials were provided or are necessary for the development tasks. Admin access is implied for CMS features, but not required for building the UI components.

**What agent forgot to execute**
-   The agent did not implement the user's final request to modify the Movie News prompt to default to Hindi when the target state is All. This is the most immediate pending task.</analysis>
